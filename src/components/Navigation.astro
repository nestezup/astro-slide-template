---
interface Props {
  slides: any[];
  currentSlug: string;
}

const { slides, currentSlug } = Astro.props;

// 현재 슬라이드의 경로에 따라 컬렉션 결정
const isQuiz = currentSlug.startsWith('python-quiz/');
const collectionPrefix = isQuiz ? 'python-quiz/' : 'python2026/';

// 해당 컬렉션의 슬라이드만 필터링
const filteredSlides = slides.filter((slide: any) => slide.id.startsWith(collectionPrefix));
const sortedSlides = filteredSlides.sort((a, b) => a.data.order - b.data.order);
const currentIndex = sortedSlides.findIndex(slide => slide.id === currentSlug);
const prevSlide = currentIndex > 0 ? sortedSlides[currentIndex - 1] : null;
const nextSlide = currentIndex < sortedSlides.length - 1 ? sortedSlides[currentIndex + 1] : null;
---

<nav class="slide-navigation">
  {prevSlide && (
    <a href={`/slides/${prevSlide.id.replace(/\.(md|mdx)$/, '')}`} class="nav-button prev" title={prevSlide.data.title}>
      <span class="nav-arrow">←</span>
    </a>
  )}
  
  <div class="nav-counter">
    {currentIndex + 1} / {sortedSlides.length}
  </div>
  
  {nextSlide && (
    <a href={`/slides/${nextSlide.id.replace(/\.(md|mdx)$/, '')}`} class="nav-button next" title={nextSlide.data.title}>
      <span class="nav-arrow">→</span>
    </a>
  )}
</nav>

<style>
  .slide-navigation {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(4px);
    padding: 0.5rem;
    border-radius: 999px;
    border: 1px solid var(--color-border);
    z-index: 100;
    transition: opacity 0.3s ease;
    opacity: 0.3; /* 흐리게 표시하여 콘텐츠 집중 */
  }

  .slide-navigation:hover {
    opacity: 1;
    background: rgba(255, 255, 255, 0.9);
  }

  .nav-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    text-decoration: none;
    color: var(--color-text);
    border-radius: 50%;
    transition: all 0.2s ease;
    background: transparent;
  }

  .nav-button:hover {
    background: var(--color-primary);
    color: white;
  }

  .nav-arrow {
    font-weight: var(--font-weight-bold);
    font-size: 1.2rem;
    line-height: 1;
  }

  .nav-counter {
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    font-size: 0.9rem;
    padding: 0 0.5rem;
    min-width: 3rem;
    text-align: center;
    font-variant-numeric: tabular-nums;
  }

  @media (max-width: 768px) {
    .slide-navigation {
      bottom: 1rem;
      right: 1rem;
      opacity: 0.8;
    }
  }
</style>